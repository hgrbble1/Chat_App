<!DOCTYPE html>
<head>
  <title>Mustache Messaging App</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
</head>
<header>
</header>
<main>
  <div class="row">
    <div class="col s12 m6">
      <div class="card blue-grey darken-1">
        <div class="card-content white-text">
          <span class="card-title">Upload File</span>
          <p>Upload your file and We will send it for you. </p>
        </div>
        <div class="card-action">
            <a id="attach" class="waves-effect waves-light btn"><i class="material-icons right">attach_file</i>File</a>
            <a id="send" class="waves-effect waves-light btn"><i class="material-icons right">send</i>Send it</a>
        </div>
      </div>
    </div>
  </div>
  <script>
    var filepath;
    var filename;
    var app = require('electron').remote;
    var dialog = app.dialog;
    const electron = require('electron');
    const {ipcRenderer} = electron;
    const file = document.querySelector('#attach');
    file.addEventListener('click', uploadFile);
    const sendButton = document.querySelector('#send');
    sendButton.addEventListener('click', sendFile);

    function uploadFile(e) {
      e.preventDefault();
      dialog.showOpenDialog((fileNames) => {
        // fileNames is an array that contains all the selected
        if(fileNames === undefined){
          console.log("No file selected");
          return;
        }
        // var url = window.location.pathname;
        // var filename = url.substring(url.lastIndexOf('/')+1);
        // alert(filename);
        console.log(fileNames[0]);
        filepath = fileNames[0];
        filename = filepath.substring(filepath.lastIndexOf('\\')+1);
        console.log(filename);
    });
  };

    function sendFile(e) {
      e.preventDefault();
      console.log('hello form the sendFile funciton');
      ipcRenderer.send('file:upload', filepath, filename);
    };
  </script>
</main>
<footer>
</footer>
<!-- <body>
<h1>Hello from the upload</h1>
</body> -->
